---
name: 2018-12-14-Translate-10
layout: post
title: '[译]Devtools tips day10 :custom formatters'
date: 2018-12-14
categories: Site
tags: [Tutorial, Chrome, Tools]
coverimg: 'http://ww1.sinaimg.cn/large/88b26e1cgy1fy6agsqgssj23zq2i2qv5.jpg'
info: '本文是作者 [Tomek Sułkowski] 发布在 [medium]上的一个系列的第10篇，这个系列一共有24篇'
---

> 本文[掘金同步连接](https://juejin.im/post/5c1365a9e51d452f8e6034cb)

### 特别声明

本文是作者 [Tomek Sułkowski](https://twitter.com/sulco) 发布在 [medium](https://medium.com/@tomsu) 上的一个系列。据作者透露一共有 24 篇，一直更新到 12 月 24 日<br>
版权归原作者所有。<br>

译者在翻译前已经和作者沟通得到了翻译整个系列的许可。<br>
为了不影响大家阅读，[许可的记录在这里](https://juejin.im/post/5c09a80151882521c81168a2)<br>

**作者在Twitter上推荐我们的中文翻译啦~~文末附图**<br>

### 正文

在马上就要迎来假期的这 24 天里，我将会发布一系列短篇的文章，关于如何更加有意思的使用开发工具，[昨天](https://juejin.im/post/5c11809ef265da61141c76f1)我们测量了一下时间 ，今天我们来聊聊...

### 28. `Custom Formatters` 自定义格式化转换器

`DevTools` 的 `console` 默认对你的对象的转化的方式在大多数的情况下都是很有用的，但是有时候你期望与众不同。很幸运的是，因为默认的方式很...默认 - 所以我们可以自定义自己的输出对象的方式。做这个事情的函数被称为 `Custom Formatter` 在我们写一个之前，我们需要在 `DevTools` 的设置 (在 `DevTools` 的 `⋮` 下拉框找到设置，或者按下 `F1` ) 中把对应的设置打开:

![](https://user-gold-cdn.xitu.io/2018/12/14/167abc4fc44e3add?w=2000&h=1396&f=png&s=336889)

所以，这样的 `formatter` 应该长什么样呢？ 它是一个最多有三个方法的对象：

- `header` —  处理如何展示在 `console` 的日志中的主要部分。
- `hasbody` —  如果你想显示一个用来展开对象的`▶` 箭头，返回 `true`
- `body` - 定义将会被显示在展开部分的内容中。

让我们一起来看一个基础的 自定义`formatter`

![](https://user-gold-cdn.xitu.io/2018/12/14/167abc4fbd4b892f?w=1092&h=610&f=png&s=48708)

> 我移除了循环的结构的错误处理，让它看起来更加简洁

`header` 方法返回了一个 [JsonML](http://www.jsonml.org/) (译者注： `JsonML`: `JSON Markup Language` `JSON` 标记语言)数组，由这些组成：

1. 标签名
2. 属性对象
3. 内容 (文本值或者其他元素)

(如果这个看起来很眼熟的话，那可能是因为你之前写过一些[React 代码](https://reactjs.org/docs/react-without-jsx.html) :D)

在输出的时候，这个简单的 `formatter` 对于每一层嵌套，直接以 7 个空格的缩进打印这个对象。所以我们的输出现在看起来是这样：

![](https://user-gold-cdn.xitu.io/2018/12/14/167abc4fc493cb88?w=884&h=654&f=gif&s=941282)

### 29.自定义格式化转换器的应用实践

现在有好几种 `custom formatter` (自定义格式化转换器)供你使用，例如：你可以在这个[immutable-devtools ](https://github.com/andrewdavey/immutable-devtools)仓库中找到对于[Immutable.js](https://facebook.github.io/immutable-js/) 结构的完美展示。但是你同样可以自己造一个。

一般来说，每当你有一些不寻常的对象的时候，或者大量的日志(最好避免这样的情况，但是有时候很有用)而且你想从中做区分的时候，你可以采用一个 `custom formatter` (自定义格式转换器)来处理。

一个很实用的窍门就是，直接将你不关心，不需要区别对待的对象过滤出来，这种情况，直接在 `header` 方法里面 `return null`。让 `DevTools` 使用默认的格式化方式来处理这些值。

好了，撇开实用性，你同样可以在它上面找点乐子 - 这儿有一个关于`console` 方法的蠢萌例子：它叫做 `console.clown()` 并且他将打印对象进行转换，而且在对象前面加上一个 emoji 表情 ... 可能是为了更好的显示吧，我猜 😁

![](https://user-gold-cdn.xitu.io/2018/12/14/167abc4fc41415ab?w=1132&h=1754&f=png&s=179986)

> [源码在这里](https://gist.github.com/sulco/e635a7511d5ff17d44fe9bb2ab8b3cc6)为了方便大家尝试，源码贴在下面：

```javascript
window.devtoolsFormatters = [{
    header: function(obj){
      if (!obj.__clown) {
        return null;
      }
      delete obj.__clown;
      const style = `
        color: red;
        border: dotted 2px gray;
        border-radius: 4px;
        padding: 5px;
      `
      const content = `🤡 ${JSON.stringify(obj, null, 2)}`;

      try {
        return ['div', {style}, content]
      } catch (err) { // for circular structures
        return null;  // use the default formatter
      }
    },
    hasBody: function(){
        return false;
    }
}]

console.clown = function (obj) {
  console.log({...obj, __clown: true});
}

console.log({message: 'hello!'});   // normal log
console.clown({message: 'hello!'}); // a silly log
```

正如你所见我正在使用 `console.clown` 方法来给打印的对象添加一个特殊的属性，所以我可以将它区分出来并且在 `formatter` (转换器) 中对它进行区别对待，但是在大部分现实的案例中，你可以这样：比如检查这个对象是不是某一个特殊类的实例等等。

Oh，`clown` 打印出来了什么东西？ 在下面：

![](https://user-gold-cdn.xitu.io/2018/12/14/167abc4fbd5ae3f6?w=896&h=450&f=png&s=42023)


今天的分享就到这里~

惯例： 如果你从这里学到了一些新东西

→ 你可以点个赞再走嘛~<br>
→ 关注我：[Twitter：Tomek Sułkowski](https://twitter.com/sulco)

### 其他系列

其他此系列的文章，马上就会翻译出来，到时会贴出对应的链接在此处。

- [【译】你不知道的 Chrome 调试工具技巧 第一天：console 中的'\$'](https://juejin.im/post/5c09a80151882521c81168a2)
- [【译】你不知道的 Chrome 调试工具技巧 第二天：copying & saving](https://juejin.im/post/5c0a0d5ff265da61117a1c75)
- [【译】你不知道的 Chrome 调试工具技巧 第三天：console methods](https://juejin.im/post/5c0a8ce6f265da6141716329)
- [【译】你不知道的 Chrome 调试工具技巧 第四天：the Elements panel（元素面板）](https://juejin.im/post/5c0d2d85f265da612061a62f)
- [【译】你不知道的 Chrome 调试工具技巧 第五天：console 的 log 中,让人疑惑的案例](https://juejin.im/post/5c0edc31f265da611c26d08a)
- [【译】你不知道的 Chrome 调试工具技巧 第六天：command 菜单](https://juejin.im/post/5c0ee12551882545e24ef291)
- [【译】你不知道的 Chrome 调试工具技巧 第七天：异步 consle 的趣味小窍门](https://juejin.im/post/5c0fdfc46fb9a049b13e0d82)
- [【译】你不知道的 Chrome 调试工具技巧 第八天：Color picker（颜色选择器）](https://juejin.im/post/5c10d9d1f265da6118019028)
- [【译】你不知道的 Chrome 调试工具技巧 第九天：给 console 计时](https://juejin.im/post/5c11809ef265da61141c76f1)
- [【译】你不知道的 Chrome 调试工具技巧 第十天：custom formatters（自定义格式转换器）](https://juejin.im/post/5c1365a9e51d452f8e6034cb)
- [【译】你不知道的 Chrome 调试工具技巧 第十一天：style editors continued（样式编辑器后续）](https://juejin.im/post/5c137ac3f265da617974b675)

### 写在最后

如果你对我的翻译表示肯定，也可以关注我一波哦~
顺便我的开源项目，求一波 star→ [看这里, 美丽的博客系统](https://github.com/DendiSe7enGitHub/vue-blog-generater)

### 作者在Twitter上推荐我们的中文翻译啦

![](https://user-gold-cdn.xitu.io/2018/12/13/167a5ae8a72ac531?imageView2/2/w/800/q/100)